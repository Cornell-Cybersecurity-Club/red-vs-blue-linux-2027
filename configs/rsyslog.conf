# Local system logging
module(load="imuxsock")

# Kernel logging (use imjournal on systemd systems if preferred)
module(load="imklog")

# Enable if using systemd and want journal integration
# module(load="imjournal" StateFile="imjournal.state")

###########################
#### GLOBAL DIRECTIVES ####
###########################

global(
    workDirectory="/var/lib/rsyslog"
    maxMessageSize="64k"
)

# Traditional log format with timestamps
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

# File permissions
$FileOwner root
$FileGroup root
$FileCreateMode 0640
$DirCreateMode 0750
$Umask 0022

# Prevent duplicate messages
$RepeatedMsgReduction on

###############
#### RULES ####
###############

# Emergency messages to all users
*.emerg                                     :omusrmsg:*

# Authentication and security
auth,authpriv.*                             /var/log/auth.log

# General system messages (exclude duplicates)
*.*;auth,authpriv.none;mail.none;cron.none  /var/log/syslog

# Kernel messages
kern.*                                      /var/log/kern.log

# Mail (async write for performance)
mail.*                                      -/var/log/mail.log

# Cron jobs
cron.*                                      /var/log/cron.log

# Daemon messages
daemon.*                                    -/var/log/daemon.log

# User messages
user.*                                      -/var/log/user.log

# Debug (optional, can be verbose)
#*.=debug;\
#    auth,authpriv.none;\
#    mail.none                              -/var/log/debug
